<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>PosPro â€” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#0d6efd" />

  <!-- Styles -->
  <link rel="stylesheet" href="css/app.css" />
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body class="auth-page">

  <div class="auth-container">
    <div class="auth-card">
      <div class="brand large">Pos<span>Pro</span></div>

      <!-- Tabs -->
      <div class="tabs">
        <button id="tabLogin" class="active">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        <button id="tabRegister">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
      </div>

      <!-- Login -->
      <form id="loginForm" class="form active">
        <input id="loginEmail" type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required />
        <input id="loginPassword" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required />
        <button type="submit" class="primary">Ø¯Ø®ÙˆÙ„</button>
        <p class="hint">ğŸ”’ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø§ ØªÙØ®Ø²Ù† Ù…Ø­Ù„ÙŠÙ‹Ø§</p>
      </form>

      <!-- Register -->
      <form id="registerForm" class="form">
        <input id="registerEmail" type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required />
        <input id="registerPassword" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required />
        <button type="submit" class="primary">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
        <p class="hint">ØªØ¬Ø±Ø¨Ø© Ù…Ø¬Ø§Ù†ÙŠØ© 14 ÙŠÙˆÙ…</p>
      </form>

      <div id="authMessage" class="message"></div>
    </div>
  </div>

  <script type="module">
    import { login, register, redirectIfLoggedIn } from './js/auth.js';

    redirectIfLoggedIn();

    const tabLogin = document.getElementById('tabLogin');
    const tabRegister = document.getElementById('tabRegister');
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    const msg = document.getElementById('authMessage');

    tabLogin.onclick = () => {
      tabLogin.classList.add('active');
      tabRegister.classList.remove('active');
      loginForm.classList.add('active');
      registerForm.classList.remove('active');
      msg.textContent = '';
    };

    tabRegister.onclick = () => {
      tabRegister.classList.add('active');
      tabLogin.classList.remove('active');
      registerForm.classList.add('active');
      loginForm.classList.remove('active');
      msg.textContent = '';
    };

    loginForm.onsubmit = async e => {
      e.preventDefault();
      msg.textContent = 'Ø¬Ø§Ø±Ù ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...';
      try {
        await login(
          loginEmail.value,
          loginPassword.value
        );
        location.href = 'index.html';
      } catch (err) {
        msg.textContent = err.message;
      }
    };

    registerForm.onsubmit = async e => {
      e.preventDefault();
      msg.textContent = 'Ø¬Ø§Ø±Ù Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨...';
      try {
        await register(
          registerEmail.value,
          registerPassword.value
        );
        location.href = 'index.html';
      } catch (err) {
        msg.textContent = err.message;
      }
    };
  </script>

</body>
</html>
